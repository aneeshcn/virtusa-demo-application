<p-table
  #dt
  [value]="data"
  [paginator]="paginator"
  [rows]="rows"
  [rowsPerPageOptions]="rowsPerPageOptions"
  [loading]="isLoading"
  [resizableColumns]="resizableColumns"
  [sortMode]="sortMode"
  [sortField]="sortField"
  [sortOrder]="sortOrder"
  [globalFilterFields]="globalFilterFields"
  [stripedRows]="stripedRows"
  [showGridlines]="gridlines"
  [selectionMode]="selectionMode"
  [(selection)]="selection"
  [frozenWidth]="frozenWidth"
  [scrollable]="frozenWidth ? true : false"
  [expandedRowKeys]="expandedRowKeys"
  responsiveLayout="scroll"
  (onPage)="onPage($event)"
  (onSort)="onSort($event)"
  (onSelectionChange)="onSelection($event)"
  class="super-table">


  <ng-template #caption>
    <div class="p-inputgroup" style="justify-content: space-between;">
      <p-button
        label="Clear"
        icon="pi pi-filter-slash"
        [outlined]="true"
        (click)="clear(dt)">
      </p-button>

      <input
        pInputText
        type="text"
        [(ngModel)]="searchValue"
        (input)="dt.filterGlobal(searchValue, 'contains')"
        placeholder="Search all columns..."
        style="width: 250px;" />
    </div>
  </ng-template>

  <ng-template pTemplate="header">
    <tr>
      <th *ngIf="selectionMode === 'multiple'">
        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
      </th>

      <th *ngFor="let col of config.columns">
        <ng-container *ngIf="col.sortable; else nonSortable">
          <th pSortableColumn="{{ col.field }}">
            {{ col.header }}
            <p-sortIcon [field]="col.field"></p-sortIcon>

            <p-columnFilter
              *ngIf="col.filter"
              [field]="col.field"
              matchMode="contains">
            </p-columnFilter>
          </th>
        </ng-container>

        <ng-template #nonSortable>
          {{ col.header }}
          <p-columnFilter
            *ngIf="col.filter"
            [field]="col.field"
            matchMode="contains">
          </p-columnFilter>
        </ng-template>
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-row>
    <tr>
      <td *ngIf="selectionMode === 'multiple'">
        <p-tableCheckbox [value]="row"></p-tableCheckbox>
      </td>

      <td *ngIf="selectionMode === 'single' && selectionType === 'radio'">
        <p-tableRadioButton [value]="row"></p-tableRadioButton>
      </td>

      <td *ngFor="let col of config.columns">
        <ng-container *ngIf="col.field === 'avatar'">
            <p-avatar [image]="row.avatar || defaultAvatar" shape="circle" size="normal">
            </p-avatar>
        </ng-container>

        <ng-container *ngIf="col.field === 'url'">
          <a
            [href]="row.url"
            target="_blank"
            rel="noopener"
            class="text-primary underline">
            {{ row.url }}
          </a>
        </ng-container>

   
        <ng-container
          *ngIf="col.editable && col.field !== 'avatar' && col.field !== 'url'; else display">
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input *ngIf="col.editor === 'text'" pInputText [(ngModel)]="row[col.field]" />
              <input *ngIf="col.editor === 'number'" type="number" pInputText [(ngModel)]="row[col.field]" />
              <p-dropdown
                *ngIf="col.editor === 'dropdown'"
                [options]="col.editorOptions"
                [(ngModel)]="row[col.field]">
              </p-dropdown>
            </ng-template>
            <ng-template pTemplate="output">
              {{ row[col.field] }}
            </ng-template>
          </p-cellEditor>
        </ng-container>

      
        <ng-template #display>
          <ng-container *ngIf="col.field !== 'avatar' && col.field !== 'url'">
            {{ row[col.field] }}
          </ng-container>
        </ng-template>

      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td [attr.colspan]="config.columns.length + (selectionMode ? 1 : 0)">
        No records found
      </td>
    </tr>
  </ng-template>

</p-table>
